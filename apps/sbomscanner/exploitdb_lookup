#!/usr/bin/env bash

## Script searches in exploitdb for any exploit by CVE

exploitdb="https://www.exploit-db.com"

if [ $# -ne 1 ]; then
  exit 1
fi
cve=$(echo $1 | tr -d '\n')

if [ -z $cve ]; then
  exit 1
fi

exploit_id=$(curl -s -k -X $'GET' -H $'Accept: application/json' \
	-H $'X-Requested-With: XMLHttpRequest' $exploitdb/search?cve=$cve | \
	python3 -m json.tool | grep exploit_id | uniq -i | cut -d':' -f2 | \
	tr -d ',"' | xargs | tr ' ' '\n' | sort -u |tr '\n' ' ' )

for i in $exploit_id
do
  if [ -z $i ]; then
    exit 1
  else
    echo "$exploitdb/exploits/$i"
  fi
done